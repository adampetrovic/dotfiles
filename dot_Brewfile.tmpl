{{/* base level packages for all environments */}}
{{- $taps := list
    "homebrew/cask"
    "homebrew/cask-fonts"
    "homebrew/cask-versions"
    "homebrew/core"
    "homebrew/bundle"
    "buo/cask-upgrade"
    "hpedrorodrigues/tools" -}}

{{- $customTaps := dict -}}

{{- $brews := list
    "asdf"
    "bind"
    "chezmoi"
    "coreutils"
    "entr"
    "git"
    "git-delta"
    "gnu-sed"
    "grep"
    "httpstat"
    "httpie"
    "mas"
    "pipenv"
    "ripgrep"
    "rsync"
    "vim"
    "watch"
    "wget"
    "zsh" -}}

{{- $casks := list
    "1password"
    "1password-cli"
    "alfred"
    "bartender"
    "brave-browser"
    "cleanshot"
    "hpedrorodrigues/tools/dockutil"
    "fantastical"
    "font-fira-code"
    "google-chrome"
    "intellij-idea"
    "istat-menus"
    "iterm2"
    "obsidian"
    "rectangle"
    "spotify"
    "tomatobar"
    "telegram" 
    "visual-studio-code" -}}

{{- $mas := dict
    "Amphetamine" "937984704"
    "Instapaper" "288545208"
    "Reeder" "1529448980"
    "Things3" "904280696" -}}

{{/* personal-specific packages */}}
{{- if .personal -}}
{{- $taps = concat $taps (list
    "fluxcd/tap"
    "go-task/tap"
    "weaveworks/tap") -}}

{{-  $brews = concat $brews (list
	"age"
	"ansible"
	"cilium-cli"
	"cloudflared"
	"direnv"
	"fluxcd/tap/flux"
    "krew"
	"weaveworks/tap/gitops"
	"go-task/tap/go-task"
	"ipcalc"
	"jq"
	"kubectl"
	"pre-commit"
	"sops"
	"yq") -}}

{{-  $casks = concat $casks (list
    "calibre"
    "kindle-previewer"
    "handbrake") -}}

{{-  $mas = merge $mas (dict
    "Wireguard" "1451685025"
    "Parcel" "639968404") -}}
{{- end -}}


{{/* work-specific packages */}}
{{- if .work -}}
{{  $customTaps = merge $customTaps (dict
    "atlassian/micros" "ssh://git@stash.atlassian.com:7997/micros/homebrew-tap.git"
    "atlassian/cloudtoken" "ssh://git@bitbucket.org/atlassian/cloudtoken-homebrew-tap.git"
    "atlassian/kubetoken" "ssh://git@stash.atlassian.com:7997/kube/homebrew-kubetoken.git") -}}

{{  $brews = concat $brews (list
    "atlas-cli") -}}

{{  $casks = concat $casks (list
    "brainfm"
    "cloudtoken"
    "slack"
    "visual-studio-code"
    "zoom") -}}

{{  $mas = merge $mas (dict
    "Wireguard" "1451685025"
    "Parcel" "639968404") -}}
{{- end -}}

{{ range ($taps | sortAlpha | uniq) -}}
tap "{{ . }}"
{{ end }}
{{ range $name, $url := $customTaps -}}
tap "{{ $name }}", "{{ $url }}"
{{ end -}}
{{ range ($brews | sortAlpha | uniq) -}}
brew "{{ . }}"
{{ end }}
{{ range ($casks | sortAlpha | uniq) -}}
cask "{{ . }}"
{{ end }}
{{ range $app, $id := $mas -}}
mas "{{ $app }}", id: {{ $id }}
{{ end }}
